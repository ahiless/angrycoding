(function(b){function f(a,c,g){var d=a.fsutils.wrapper,e=d.data("movie");if(!e)return d=Array.prototype.slice.call(arguments),a.fsutils.startupQueue.push(d);e.setParams(g);d.data("callback",c);d.data("target",a);e=a.offset();d.css({left:e.left,top:e.top,width:a.outerWidth(),height:a.outerHeight()})}b.fn.extend({fsutils:{startupQueue:[],wrapper:b({elmToReplace:null,flashIsInstalled:null,defaultFlashVersion:7,replace:function(a,c,g,d,e,b,f){typeof a==="string"&&(a=document.getElementById(a));this.elmToReplace=
a;this.flashIsInstalled=this.checkForFlash(b||this.defaultFlashVersion);if(this.elmToReplace&&this.flashIsInstalled){a="<object"+(window.ActiveXObject?' id="'+g+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" data="'+c+'"':"");a+=' width="'+d+'"';a+=' height="'+e+'"';a+=">";b="<param";b+=' name="movie"';b+=' value="'+c+'"';b+=">";b+="";var i="",j="",h;for(h in f)i+='<param name="'+h+'" value="'+f[h]+'">',j+=" "+h+'="'+f[h]+'"';this.elmToReplace.innerHTML=a+b+i+('<embed id="'+g+'" src="'+c+
'" type="application/x-shockwave-flash" width="'+d+'" height="'+e+'"')+(j+"></embed>")+"</object>"}return this.elmToReplace},checkForFlash:function(a){this.flashIsInstalled=!1;var c;if(window.ActiveXObject)try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+a),this.flashIsInstalled=!0}catch(b){}else if(navigator.plugins&&navigator.mimeTypes.length>0&&(c=navigator.plugins["Shockwave Flash"])&&navigator.plugins["Shockwave Flash"].description.replace(/.*\s(\d+\.\d+).*/,"$1")>=a)this.flashIsInstalled=
!0;return this.flashIsInstalled}}.replace(document.createElement("div"),["script/fsutils.swf",Math.random()].join("?"),"",900,900,9,{FlashVars:"onload=jQuery().fsutils.init",wmode:"transparent"})).css({position:"absolute","z-index":"10000000",top:"-100000px",left:"-100000px",overflow:"hidden"}).appendTo(document.documentElement),init:function(){var a=b("*[id]",this.wrapper)[0];this.wrapper.data("movie",a);a.addEventListener("onmouseevent",function(a){var b=jQuery().fsutils.wrapper,d=b.position();
a.type=="mouseout"&&b.css({top:"-100000px",left:"-100000px"});b.data("target").trigger(jQuery.Event(a.type,{pageX:d.left+a.stageX,pageY:d.top+a.stageY}))}.toString());a.addEventListener("onload",function(){var a=jQuery().fsutils.wrapper;return a.data("callback").apply(a.data("target"),arguments)}.toString());for(a.addEventListener("onsave",function(){var a=jQuery().fsutils.wrapper;return a.data("callback").apply(a.data("target"),arguments)}.toString());this.startupQueue.length;)f.apply(this,this.startupQueue.pop())}},
openFileDialog:function(a,c){this.mouseover(function(){var g=b(this);f(g,a,{dialogType:"open",cursor:g.css("cursor"),fileFilter:c.join(";")})});return b(this)},saveFileDialog:function(a){this.mouseover(function(){var c=b(this);f(c,a,{dialogType:"save",cursor:c.css("cursor")})});return b(this)}})})(jQuery);
